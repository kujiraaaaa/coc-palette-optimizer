(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const t of s.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&o(t)}).observe(document,{childList:!0,subtree:!0});function i(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(e){if(e.ep)return;e.ep=!0;const s=i(e);fetch(e.href,s)}})();const d=document.getElementById("input-palette"),a=document.getElementById("output-palette"),m=document.getElementById("optimize-button"),C=document.getElementById("copy-button");m.addEventListener("click",()=>{const u=d.value,r=B(u);a.value=r});C.addEventListener("click",()=>{a.select(),navigator.clipboard.writeText(a.value).then(()=>alert("コピーしました！")).catch(u=>alert("コピーに失敗しました: "+u))});function B(u){if(!u.trim())return"";const r=u.split(`
`),i={},o={};let e=0;const s={回避:0,キック:25,組み付き:25,"こぶし（パンチ）":50,頭突き:10,投擲:25,マーシャルアーツ:1,拳銃:20,サブマシンガン:15,ショットガン:30,マシンガン:15,ライフル:25,応急手当:30,鍵開け:1,隠す:15,隠れる:10,聞き耳:25,忍び歩き:10,写真術:10,精神分析:1,追跡:10,登攀:40,図書館:25,目星:25,運転:20,機械修理:20,重機械操作:1,乗馬:5,水泳:25,製作:5,操縦:1,跳躍:25,電気修理:10,ナビゲート:10,変装:1,言いくるめ:5,信用:15,説得:15,値切り:5,母国語:0,医学:5,オカルト:5,化学:1,クトゥルフ神話:0,芸術:5,経理:10,考古学:1,コンピューター:1,心理学:5,人類学:1,生物学:1,地質学:1,電子工学:1,天文学:1,博物学:10,物理学:1,法律:5,薬学:1,歴史:20};r.forEach(c=>{let n=c.match(/1d100<={SAN}\s*.*【正気度ロール】/);if(n){e=1;return}if(n=c.match(/CCB<=(\d+)\*5 【(STR|CON|POW|DEX|APP|SIZ|INT|EDU) × 5】/),n){i[n[2]]=parseInt(n[1]);return}if(n=c.match(/CCB<=(\d+)\s*【(.+)】/),n){const l=n[2],p=parseInt(n[1]);["アイデア","幸運","知識"].includes(l)||(o[l]=p)}});const t=[];e>0&&t.push("1d100<={SAN} 【正気度ロール】"),t.push("---"),i.STR&&t.push("CCB<={STR}*5 【STR×5】"),i.CON&&t.push("CCB<={CON}*5 【CON×5】（ショックロール）"),i.POW&&t.push("CCB<={POW}*5 【POW×5】（幸運）"),i.DEX&&t.push("CCB<={DEX}*5 【DEX×5】"),i.APP&&t.push("CCB<={APP}*5 【APP×5】"),i.SIZ&&t.push("CCB<={SIZ}*5 【SIZ×5】"),i.INT&&t.push("CCB<={INT}*5 【INT×5】（アイデア）"),i.EDU&&t.push("CCB<={EDU}*5 【EDU×5】（知識・母国語）"),t.push("---");const h=[],f=[];for(const c in o){const n=o[c],l=s[c.replace(/《.+》/,"")]??-1,p=`CCB<=${n} 【${c}】`;n>l?h.push(p):f.push(p)}return t.push(...h),t.push("---"),t.push(...f),t.push("---"),t.push("1D3+{DB} 【こぶしダメージ判定】"),t.push("1D6+{DB} 【キックダメージ判定】"),o.マーシャルアーツ>s.マーシャルアーツ&&(t.push("2D3+{DB} 【こぶし+マーシャルアーツダメージ判定】"),t.push("2D6+{DB} 【キック+マーシャルアーツダメージ判定】")),t.push("1D3 【応急手当回復値判定】"),o.医学>s.医学&&t.push("2D3 【医学回復値判定】"),t.push("---"),t.push("CCB<="),t.push("---"),t.push(`・組み合わせロール
CBRB(x,y)`),t.push("---"),t.push(`・抵抗表ロール
RESB(x-y)`),t.push("---"),t.push("choice[A,B,C]"),t.push("---"),t.push(`・パラメータ操作
:SAN
:HP
:MP`),t.join(`
`)}
